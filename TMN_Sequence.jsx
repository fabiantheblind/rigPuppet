// written by fabiantheblind// based on Andrew Reynolds Sequencer.jsx http://www.videocopilot.net/// based on Dan Ebberts preCompToLayerDur.jsx http://www.motionscript.com// with a little help by Paul Tuersley http://forums.adobe.com/people/Paul%20Tuersleyfunction Sequence(){    	app.beginUndoGroup("SEquence Layers");    var curComp = app.project.activeItem;    if (!curComp || !(curComp instanceof CompItem))    {        alert("Please select a Composition.");        return;    }    var offsetFrames = 1;//parseInt(prompt("Number of frames to offset", "1"));    for (var layerId = 0; layerId < curComp.selectedLayers.length; layerId++)     {        var layer = curComp.selectedLayers[layerId];                layer.startTime = layerId * offsetFrames * curComp.frameDuration;				layer.outPoint = layer.inPoint +1*curComp.frameDuration;    }		var myLayers = curComp.selectedLayers;	var newInPoint = myLayers[0].inPoint;      var newOutPoint = myLayers[0].outPoint;	  var newCompName = "comp_";      var layerName = myLayers[0].name;      if(layerName.length > 26) {        layerName = layerName.substring(0, 26);		      }  /*  newCompName += layerName;  // "precompose" expects an array of layer indices  var layerIndices = new Array();      for (var i = 0; i < myLayers.length; i++) {        layerIndices[layerIndices.length] = myLayers[i].index;        // make sure new comp in point is in point of earliest layer        // and new comp out point is out point of latest layer        if (myLayers[i].inPoint < newInPoint) newInPoint = myLayers[i].inPoint;        if (myLayers[i].outPoint > newOutPoint) newOutPoint = myLayers[i].outPoint;      }  // create the new comp      var newComp = curComp.layers.precompose(layerIndices, newCompName, true );      // set in and out points of new comp      var preCompLayer = curComp.selectedLayers[0];      preCompLayer.inPoint = newInPoint;      preCompLayer.outPoint = newOutPoint;	  preCompLayer.timeRemapEnabled = true;      var holdInt = KeyframeInterpolationType.HOLD;      var property = preCompLayer.property("ADBE Time Remapping");       for (var i = 1; i <= property.numKeys; i++){        property.setInterpolationTypeAtKey(i, holdInt, holdInt);        }		*/app.endUndoGroup();    }Sequence();